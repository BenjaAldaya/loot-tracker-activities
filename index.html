<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Albion Loot Tracker - CAZA GANKER</title>
    <link rel="stylesheet" href="css/styles.css">

    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7932865041252287"
     crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <div style="display: flex; align-items: center; gap: 16px; flex-wrap: wrap;">
                    <h1>
                        üéÆ Albion Loot Tracker
                        <span id="utcTime"
                            style="font-size: 14px; font-weight: normal; color: var(--text-secondary); margin-left: 12px; background: rgba(255, 255, 255, 0.1); padding: 4px 8px; border-radius: 4px;">
                            00:00:00 UTC
                        </span>
                    </h1>
                    <div id="activityBadge" class="activity-badge hidden">
                        <span class="pulse-dot"></span>
                        <span id="activityBadgeText">Actividad en curso</span>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="app.newActivity()">‚ûï Nueva Actividad</button>
            </div>
            <div class="header-nav">
                <div class="nav-group">
                    <span class="nav-label">General</span>
                    <button class="btn btn-nav" onclick="app.showConfig()">‚öôÔ∏è Configuraci√≥n</button>
                    <button class="btn btn-nav" onclick="app.showHistory()">üìä Historial</button>
                    <button class="btn btn-nav" onclick="window.location.href='other-kills.html'">üè∞ Otras Kills</button>
                </div>
                <div class="nav-group">
                    <span class="nav-label">Datos</span>
                    <button class="btn btn-nav" onclick="app.exportAllData()">üíæ Exportar</button>
                    <button class="btn btn-nav" onclick="app.importDataFromJSON()">üìÇ Importar</button>
                </div>
                <div class="nav-group">
                    <span class="nav-label">Herramientas</span>
                    <button class="btn btn-nav" onclick="app.showDiagnostics()">üîß Diagn√≥stico</button>
                </div>
            </div>
        </div>

        <!-- Ad Banner Superior -->
        <div style="text-align: center; margin: 16px 0; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 8px;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-7932865041252287"
                 data-ad-slot="1234567890"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>

        <!-- Main Content -->
        <div id="mainContent">
            <!-- Welcome Screen -->
            <div id="welcomeScreen" class="card">
                <div class="empty-state">
                    <div class="empty-state-icon">üéØ</div>
                    <div class="empty-state-text">Bienvenido a Albion Loot Tracker</div>
                    <div class="empty-state-subtext">Configura tu gremio para comenzar</div>
                    <button class="btn btn-primary" onclick="app.showConfig()" style="margin-top: 24px;">
                        ‚öôÔ∏è Configurar Gremio
                    </button>
                </div>
            </div>

            <!-- Active Activity Screen -->
            <div id="activityScreen" class="hidden">
                <!-- Activity Status -->
                <div class="card">
                    <div class="card-title">üìä Actividad Actual: <span id="activityName">-</span></div>
                    <div class="activity-status">
                        <div class="status-item">
                            <div class="status-label">Duraci√≥n</div>
                            <div class="status-value" id="activityDuration">00:00:00</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">Kills</div>
                            <div class="status-value" id="totalKills">0</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">Deaths</div>
                            <div class="status-value" id="totalDeaths">0</div>
                        </div>
                        <div class="status-item">
                            <div class="status-label">Fame</div>
                            <div class="status-value" id="totalFame">0</div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 12px; margin-top: 16px;">
                        <button class="btn btn-success" onclick="app.showAddParticipantModal()">‚ûï Agregar
                            Participante</button>
                        <button class="btn btn-danger" onclick="app.endActivity()">‚èπÔ∏è Finalizar Actividad</button>
                    </div>
                </div>

                <!-- Participants -->
                <div class="card">
                    <div class="card-title">üë• Participantes (<span id="participantCount">0</span>)</div>
                    <div id="participantsList"></div>
                </div>

                <!-- Ad Banner Medio -->
                <div style="margin: 16px 0; padding: 12px; text-align: center; background: rgba(255,255,255,0.03); border-radius: 8px;">
                    <ins class="adsbygoogle"
                         style="display:block"
                         data-ad-format="fluid"
                         data-ad-layout-key="-6t+ed+2i-1n-4w"
                         data-ad-client="ca-pub-7932865041252287"
                         data-ad-slot="9876543210"></ins>
                    <script>
                         (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <!-- Loot Chest -->
                <div class="card">
                    <div class="card-title">
                        üì¶ Ba√∫l de Bot√≠n
                        <button class="btn btn-secondary" onclick="app.showEditChestNameModal()"
                            style="padding: 4px 12px; font-size: 12px; margin-left: 12px;">
                            ‚úèÔ∏è Cambiar Nombre
                        </button>
                    </div>
                    <div id="lootChestContainer"></div>
                </div>

                <!-- Pending Kills -->
                <div class="card">
                    <div class="card-title">
                        üîî Kills Pendientes (<span id="pendingKillsCount">0</span>)
                        <span style="margin-left: auto; font-size: 14px; color: var(--text-secondary);">
                            üîÑ √öltima actualizaci√≥n: <span id="lastUpdate">-</span>
                        </span>
                    </div>
                    <div id="pendingKillsList"></div>
                </div>

                <!-- Confirmed Kills -->
                <div class="card">
                    <div class="card-title">‚úÖ Kills Confirmadas (<span id="confirmedKillsCount">0</span>)</div>
                    <div id="confirmedKillsList"></div>
                </div>
            </div>
        </div>

        <!-- Ad Banner Inferior -->
        <div style="text-align: center; margin-top: 24px; padding: 12px; background: rgba(255,255,255,0.03); border-radius: 8px;">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-7932865041252287"
                 data-ad-slot="5555555555"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                 (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
    </div>

    <!-- Configuration Modal -->
    <div id="configModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <div class="modal-title">‚öôÔ∏è Configuraci√≥n del Gremio</div>
                <button class="close-btn" onclick="app.closeModal('configModal')">√ó</button>
            </div>

            <!-- Search Guild Section -->
            <div style="background: rgba(0, 217, 255, 0.1); padding: 20px; border-radius: 12px; margin-bottom: 24px;">
                <div style="font-weight: 600; font-size: 16px; margin-bottom: 12px;">üîç Buscar Gremio</div>
                <div style="font-size: 14px; color: var(--text-secondary); margin-bottom: 16px;">
                    Busca tu gremio en la API de Albion Online para cargar autom√°ticamente todos los miembros y el ID
                    del gremio
                </div>

                <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                    <input type="text" id="guildSearchInput" class="form-input"
                        placeholder="Nombre del gremio (ej: CAZA GANKER)" style="flex: 1;"
                        onkeypress="if(event.key === 'Enter') app.searchGuild()">
                    <button class="btn btn-primary" onclick="app.searchGuild()" style="min-width: 120px;">
                        üîç Buscar
                    </button>
                </div>

                <!-- Search Results -->
                <div id="guildSearchResults" style="display: none; margin-top: 16px;"></div>
            </div>

            <div style="text-align: center; margin: 24px 0; color: var(--text-secondary); font-size: 14px;">
                ‚îÄ‚îÄ‚îÄ o configuraci√≥n manual ‚îÄ‚îÄ‚îÄ
            </div>

            <!-- Manual Configuration -->
            <div id="manualConfigSection">
                <div class="form-group">
                    <label class="form-label">Nombre del Gremio</label>
                    <input type="text" id="guildNameInput" class="form-input" placeholder="Mi Gremio">
                </div>
                <div class="form-group">
                    <label class="form-label">
                        ID del Gremio (opcional)
                        <span style="font-size: 12px; color: var(--text-secondary); font-weight: normal;">
                            - Se obtiene autom√°ticamente al buscar
                        </span>
                    </label>
                    <input type="text" id="guildIdInput" class="form-input" placeholder="ID del gremio" readonly
                        style="background: rgba(255, 255, 255, 0.05);">
                </div>
                <div class="form-group">
                    <label class="form-label">
                        Miembros del Gremio (uno por l√≠nea)
                        <button class="btn btn-secondary" onclick="app.refreshGuildMembers()"
                            style="padding: 4px 12px; font-size: 12px; margin-left: 8px;">
                            üîÑ Actualizar desde API
                        </button>
                    </label>
                    <textarea id="guildMembersInput" class="form-input" rows="10"
                        placeholder="Jugador1&#10;Jugador2&#10;Jugador3"></textarea>
                    <small style="color: var(--text-secondary);">Los nombres deben coincidir exactamente con los de
                        Albion
                        Online</small>
                </div>
            </div>

            <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 24px;">
                <button class="btn btn-secondary" onclick="app.closeModal('configModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="app.saveConfigFromForm()">üíæ Guardar Configuraci√≥n</button>
            </div>
        </div>
    </div>

    <!-- New Activity Modal -->
    <div id="newActivityModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">‚ûï Nueva Actividad</div>
                <button class="close-btn" onclick="app.closeModal('newActivityModal')">√ó</button>
            </div>
            <div class="form-group">
                <label class="form-label">Nombre de la Actividad</label>
                <input type="text" id="activityNameInput" class="form-input" placeholder="Cacer√≠a Noche">
            </div>
            <div class="form-group">
                <label class="form-label">Ciudad para Precios de Mercado</label>
                <select id="activityCitySelect" class="form-input">
                    <option value="Caerleon">Caerleon (Black Market)</option>
                    <option value="Bridgewatch">Bridgewatch</option>
                    <option value="Lymhurst">Lymhurst</option>
                    <option value="Martlock">Martlock</option>
                    <option value="Thetford">Thetford</option>
                    <option value="Fort Sterling">Fort Sterling</option>
                    <option value="Brecilien">Brecilien</option>
                </select>
                <small style="color: var(--text-secondary);">Se usar√° para calcular el valor del ba√∫l de bot√≠n</small>
            </div>
            <div class="form-group">
                <label class="form-label">
                    Seleccionar Participantes
                    <button class="btn btn-success" onclick="app.selectAllParticipants()"
                        style="padding: 4px 12px; font-size: 12px; margin-left: 8px;">
                        ‚úì Todos
                    </button>
                    <button class="btn btn-secondary" onclick="app.deselectAllParticipants()"
                        style="padding: 4px 12px; font-size: 12px;">
                        ‚úó Ninguno
                    </button>
                </label>
                <input type="text" id="participantSearchInput" class="form-input"
                    placeholder="üîç Buscar participante..." oninput="app.filterParticipants(this.value)"
                    style="margin-bottom: 12px;">
                <div id="participantSelection" style="max-height: 300px; overflow-y: auto;"></div>
            </div>
            <div style="display: flex; gap: 12px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="app.closeModal('newActivityModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="app.startActivity()">üöÄ Iniciar Actividad</button>
            </div>
        </div>
    </div>

    <!-- Add Participant Modal -->
    <div id="addParticipantModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">‚ûï Agregar Participante</div>
                <button class="close-btn" onclick="app.closeModal('addParticipantModal')">√ó</button>
            </div>
            <div class="form-group">
                <label class="form-label">Seleccionar Participante</label>
                <input type="text" id="addParticipantSearchInput" class="form-input"
                    placeholder="üîç Buscar participante..." oninput="app.filterAddParticipants(this.value)"
                    style="margin-bottom: 12px;">
                <div id="addParticipantSelection" style="max-height: 300px; overflow-y: auto;"></div>
            </div>
            <div style="display: flex; gap: 12px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="app.closeModal('addParticipantModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="app.confirmAddParticipant()">‚ûï Agregar</button>
            </div>
        </div>
    </div>

    <!-- History Modal -->
    <div id="historyModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üìä Historial de Actividades</div>
                <button class="close-btn" onclick="app.closeModal('historyModal')">√ó</button>
            </div>
            <div id="historyList" style="max-height: 600px; overflow-y: auto;"></div>
        </div>
    </div>

    <!-- Kill Detail Modal -->
    <div id="killDetailModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <div class="modal-title">üó°Ô∏è Detalle de Kill</div>
                <button class="close-btn" onclick="app.closeModal('killDetailModal')">√ó</button>
            </div>
            <div id="killDetailContent"></div>
        </div>
    </div>

    <!-- Edit Loot Modal -->
    <div id="editLootModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">‚úèÔ∏è Editar Loot</div>
                <button class="close-btn" onclick="app.closeModal('editLootModal')">√ó</button>
            </div>
            <div id="editLootContent"></div>
        </div>
    </div>

    <!-- Edit Chest Name Modal -->
    <div id="editChestNameModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üì¶ Cambiar Nombre del Ba√∫l</div>
                <button class="close-btn" onclick="app.closeModal('editChestNameModal')">√ó</button>
            </div>
            <div class="form-group">
                <label class="form-label">Nombre del Ba√∫l</label>
                <input type="text" id="chestNameInput" class="form-input" placeholder="Ej: Ba√∫l de Raid Semanal">
                <small style="color: var(--text-secondary);">Dale un nombre al ba√∫l como lo har√≠as en el juego</small>
            </div>
            <div style="display: flex; gap: 12px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="app.closeModal('editChestNameModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="app.confirmChestName()">üíæ Guardar</button>
            </div>
        </div>
    </div>

    <!-- Diagnostics Modal -->
    <div id="diagnosticsModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <div class="modal-title">üîß Panel de Diagn√≥stico</div>
                <button class="close-btn" onclick="app.closeModal('diagnosticsModal')">√ó</button>
            </div>
            <div id="diagnosticsContent" style="font-family: 'Courier New', monospace; font-size: 13px;"></div>
            <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 16px;">
                <button class="btn btn-primary" onclick="app.refreshDiagnostics()">üîÑ Actualizar</button>
                <button class="btn btn-secondary" onclick="app.closeModal('diagnosticsModal')">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- JavaScript Modules (in dependency order) -->
    <script src="js/storage.js"></script>
    <script src="js/api-service.js"></script>
    <script src="js/price-service.js"></script>
    <script src="js/models.js"></script>
    <script src="js/ui-manager.js"></script>
    <script src="js/app.js"></script>
</body>

</html>